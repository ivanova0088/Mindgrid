<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MindGrid â€“ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#f4f7fb;margin:0;color:#0b1620}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:14px 16px;background:#fff;border-bottom:1px solid #e7edf3;position:sticky;top:0}
    header .tag{background:#e8f7ff;color:#056; padding:4px 8px;border-radius:8px;font-size:12px}
    .wrap{max-width:840px;margin:24px auto;padding:0 16px}
    .card{background:#fff;border:1px solid #e7edf3;border-radius:16px;padding:18px 16px;margin-bottom:16px;box-shadow:0 1px 0 rgba(0,0,0,.02)}
    .title{font-size:28px;margin:8px 0 14px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .btn{background:#0aa3c2;color:#fff;border:none;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer}
    .btn:disabled{opacity:.55;cursor:not-allowed}
    .muted{color:#566b7f}
    .warn{background:#fff4e5;border:1px solid #ffd9aa;color:#7a3e00;padding:10px 12px;border-radius:10px}
    .ok{background:#e9fbf0;border:1px solid #c6f0d6;color:#095c2d;padding:10px 12px;border-radius:10px}
    .danger{background:#ffecec;border:1px solid #ffc7c7;color:#7d0b0b;padding:10px 12px;border-radius:10px}
  </style>
</head>
<body>
  <header>
    <div style="display:flex;gap:10px;align-items:center">
      <strong>MindGrid ğŸ§ </strong>
      <span class="tag" id="buildTag">mg_fix5</span>
    </div>
    <div style="display:flex;gap:8px">
      <button class="btn" id="reload">ØªØ­Ø¯ÙŠØ«</button>
    </div>
  </header>

  <div class="wrap">
    <div class="card">
      <div class="title">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
      <div id="status" class="warn">Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨ØªØ§Øªâ€¦</div>
    </div>

    <div class="card">
      <h3 style="margin:0 0 8px">Ø§Ø®ØªØ± Ø§Ù„Ù†Ù…Ø·</h3>
      <p class="muted" style="margin-top:0">Ù†Ù…Ø·Ø§Ù† Ø¬Ø¯ÙŠØ¯Ø§Ù†: Ø§Ù„Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ù…ØªØ¯Ø§Ø®Ù„Ø© (Orbit) ÙˆØ§Ù„Ø³ÙÙ‘Ù„ÙÙ‘Ù… (Ladder).</p>
      <div class="row">
        <div class="card" style="margin:0">
          <h3 style="margin:0 0 6px">Ø§Ù„Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ù…ØªØ¯Ø§Ø®Ù„Ø©</h3>
          <p class="muted">Ø£Ù‚ÙˆØ§Ø³ Ø¯Ø§Ø¦Ø±ÙŠØ© ØªØªÙ‚Ø§Ø·Ø¹ Ù…Ø¹ Ø£Ø´Ø¹Ù‘Ø©.</p>
          <button id="go-orbit" class="btn">Ø§Ø¨Ø¯Ø£</button>
        </div>
        <div class="card" style="margin:0">
          <h3 style="margin:0 0 6px">Ø§Ù„Ø³ÙÙ‘Ù„ÙÙ‘Ù…</h3>
          <p class="muted">Ø£Ø¹Ù…Ø¯Ø© ÙƒÙ„Ù…Ø§Øª ØªØ±Ø¨Ø·Ù‡Ø§ Ø¯Ø±Ø¬Ø§Øª â€” Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„.</p>
          <button id="go-ladder" class="btn">Ø§Ø¨Ø¯Ø£</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ÙƒØ³Ø± Ø§Ù„ÙƒØ§Ø´
    const qs = new URLSearchParams(location.search);
    const V = qs.get('v') || 'mg_fix5';
    const CB = qs.get('cb') || String(Date.now()).slice(-6);
    document.getElementById('buildTag').textContent = V;
    document.getElementById('reload').onclick = () => {
      const u = new URL(location.href);
      u.searchParams.set('cb', Date.now());
      location.href = u.toString();
    };

    const statusEl = document.getElementById('status');

    function loadScript(src){
      return new Promise((resolve, reject)=>{
        const s = document.createElement('script');
        s.src = `${src}?v=${encodeURIComponent(V)}&cb=${encodeURIComponent(CB)}`;
        s.async = true;
        s.onload = () => resolve(src);
        s.onerror = () => reject(src);
        document.head.appendChild(s);
      });
    }

    (async function boot(){
      try {
        // Ø­Ù…Ù‘Ù„ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø£ÙˆÙ„Ø§Ù‹
        await loadScript('./js/library.js');

        // Ø«Ù… Ø§Ù„Ø£Ù†Ù…Ø§Ø· (Ù„Ø§ Ù…Ø´ÙƒÙ„Ø© Ø¥Ù† ÙØ´Ù„ Ø£Ø­Ø¯Ù‡Ù…Ø§Ø› Ø³Ù†Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ÙˆØ§Ø¶Ø­Ø©)
        const results = await Promise.allSettled([
          loadScript('./js/orbit.js'),
          loadScript('./js/ladder.js')
        ]);

        const failed = results.filter(r => r.status === 'rejected').map(r => r.reason);
        if (failed.length) {
          statusEl.className = 'danger';
          statusEl.innerHTML = 'ØªØ¹Ø°Ù‘Ø± ØªØ­Ù…ÙŠÙ„: <b>' + failed.join(', ') +
            '</b> â€” ØªØ£ÙƒÙ‘Ø¯ Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø± ÙˆØ­Ø§Ù„Ø© Ø§Ù„Ø£Ø­Ø±Ù (js/â€¦ Ùˆ content/â€¦).';
        } else {
          statusEl.className = 'ok';
          statusEl.textContent = 'ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨ØªØ§Øª Ø¨Ù†Ø¬Ø§Ø­. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¢Ù†.';
        }

        // Ø£Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¨Ø§Ù„Ø¯ÙˆØ§Ù„ Ø¥Ù† ÙˆÙØ¬Ø¯Øª
        const goOrbit  = document.getElementById('go-orbit');
        const goLadder = document.getElementById('go-ladder');

        goOrbit.onclick = () => {
          if (window.MG && typeof MG.openOrbit === 'function') MG.openOrbit();
          else alert('Ù„Ù… ÙŠØªÙ… ØªØ¹Ø±ÙŠÙ MG.openOrbit â€” ØªØ£ÙƒÙ‘Ø¯ Ù…Ù† js/orbit.js ÙˆØ£Ù†Ù‡ ÙŠØ¹Ø±Ù‘Ù Ø§Ù„Ø¯Ø§Ù„Ø©.');
        };

        goLadder.onclick = () => {
          if (window.MG && typeof MG.openLadder === 'function') MG.openLadder();
          else alert('Ù„Ù… ÙŠØªÙ… ØªØ¹Ø±ÙŠÙ MG.openLadder â€” ØªØ£ÙƒÙ‘Ø¯ Ù…Ù† js/ladder.js ÙˆØ£Ù†Ù‡ ÙŠØ¹Ø±Ù‘Ù Ø§Ù„Ø¯Ø§Ù„Ø©.');
        };

      } catch (e) {
        statusEl.className = 'danger';
        statusEl.innerHTML = 'ØªØ¹Ø°Ù‘Ø± ØªØ­Ù…ÙŠÙ„: <b>' + e + '</b>. Ø§Ù„Ù…Ø³Ø§Ø± Ø£Ùˆ Ø§Ù„Ø§Ø³Ù… ØºÙŠØ± ØµØ­ÙŠØ­.';
      }
    })();
  </script>
</body>
</html>
